<!DOCTYPE html>

<html lang="en">
    <head>
<meta charset="utf-8">


<!-- Load d3.js -->
<script type="text/javascript" src="d3.js"></script>
        


<style type="text/css">
            
        @import url('https://fonts.googleapis.com/css?family=Quicksand');
        @import url('https://fonts.googleapis.com/css?family=Inter');
        @import url('https://fonts.googleapis.com/css?family=Lora');
        @import url('https://fonts.googleapis.com/css?family=EB+Garamond');
        @import url('https://fonts.googleapis.com/css?family=Cormorant+Garamond');
html {
  scroll-behavior: smooth;
}
        body {
            background-image: url("Final_Project/PlanetsPng/background_copy.jpg");
            background-repeat: no-repeat;
            background-size: 100%; 
            background-color: black;
            color: white;
            position: relative;
            text-align: center;
            margin: 20%;
            align-content: center;
        }

        .column {
            width: 25%;
            float: left;
        }
        .column img:hover {
            width:80%;
        }

        .header {

            font-family: 'Cormorant Garamond';
            margin-top: 20%;

        }

        h1 {                
            font-size: 9ex;
            margin-top: 80px;
            margin-bottom: 10px;
            letter-spacing: .3em;
        }
        h2 {
            font-size: 25px;
        }

        .spacejunk {
            font-size: 2ex;
            margin-top: 42%;
            margin-bottom:5%;
        }

        #nav {
            margin-bottom:70px;
        }
    
        #nav a.active {
                color:white;
            }
    
        ul {
            list-style-type: none;
            margin: 15px;
            padding: 0;
            float:center;
            }
    
        li {
            display: inline;
        }
    
        li a {
            text-decoration: none;
            margin-left:30px;
            margin-right:30px;
            color:grey;
            font-size: 3ex;
            }
    
        li a:hover {
            color:white;
        }

        #content {
            margin-top:300px;
            margin-left:5%;
            margin-right:5%;
            height:400px;
            overflow: hidden;
        }
    
    
    #objects {

        float:left;
        width:50%;
    }
    
    #objects-explanation {

        margin-top:40px;
        width:45%;
        float:left;
        margin-left:5%;
        text-align:left;

    }
    
 
    
    #objects-explanation p1 {
        font-size: 25px;
        font-weight: 200;
        
    }
    
    #status {
        float:none;
        margin-top:500px;

    }
   
    #status-explanation {
      align-content:center;
        margin:auto;
        margin-top:10px;

    }
    
    #status-explanation p1 {
        float:left;
        margin-left:10%;
        color:#D34418;
        font-size:40px;
        text-align:end;
        margin-top:10px;
        
    }
    
    #status-explanation p {
          width:500px;
        text-align:justify;
          margin-top:50px;
          margin-left:480px;
        font-size:18px;
          
    }
    
    #orbit img {
        width:70%;
    }
    
    
    #orbits-explanation {
        width:35%;
        float:left;
        margin-left:4%;
        margin-top:15px;
        text-align:end;
        font-size:12px;
        
    }
    
       #orbits-explanation p1 {
        font-size:25px;
        font-weight:200;
        text-align:right;
        
    }
    
    
    #orbits-chart {
        width:60%;
        float:left;
    }
    

        img {
            width: 60%;
        }

        #mars {
            margin-top:100px;
            display:none;
 
        }
    
        #chart {
            margin-top:100px;
        }

        
        #piechart {
            width:100%;
            margin-top:400px;
            float:none;
        }
    
    #piechart-explanation {
        text-align:justify;
        width:85%;
        margin:auto;
    }


        .eachplanet {
            width:13.5%;
            float:left;
        }


        .eachplanet img {
            filter:grayscale(1);
            width:100%;
        }

        .eachplanet img:hover {
            filter:grayscale(0);
        }
    #placeholder {

        height: 100px;
    }

            
		</style>
	</head>
	<body>	
        
        <div class="header">
            <h1>SPACE ANTHROPOCENE 2.0</h1>
            <h2>Historical and Cultural Survey of the Human Activities in Earth's Orbit and Beyond Through the Lens of Data Visualization</h2>
        </div>
        
        <div class="spacejunk">
            <p1>We have launched an abundance of rockets and thousands more satellites into orbit since the 1950s, when the space era first began. Since the launch of Sputnik, the first artificial satellite to orbit Earth, by the U.S.S.R. on October 4, 1957, humans have been exploring the space. This took place during the Cold War, a time when the Soviet Union and the United States were at odds politically. There are still plenty, and as we launch more, the probability of collision grows. Thousands of defunct satellites as well as fragments from all the rockets we've ever fired are in orbit around our planet. Any human-made item in orbit around the Earth that is no longer usable is known as orbital trash. Non-operational spacecraft, abandoned launch vehicle stages, mission-related junk, and fragmentation debris are examples of this debris. Fortunately, space trash doesn't currently represent a serious threat to our explorations. Its greatest threat is to other satellites that are in orbit.<br><br>To avoid being hit, damaged, or destroyed by all this approaching space junk, these satellites must maneuver out of the path. Every year, hundreds of collision avoidance maneuvers are carried out across all satellites. If there is too much space debris in orbit, the Earth's orbit may become unstable due to a chain reaction whereby more and more objects hit and produce fresh space debris. This condition is known as the Kessler Syndrome. Although this scenario would be severe, some experts are concerned that a variation of it might become an issue in the future. In addition to the debris we've left in Earth's orbit, there are other items on the lunar surface and other planets. Space Anthropocene 2.0 has displayed the objects and detritus left in space to investigate these explorations and see how it has altered over time. Data from NASA and the UN were used to collect and evaluate events between 1957 and 2022.
</p1>
            <figure>
                <!--<img src="Final_Project/PlanetsPng/space_debris.jpg">-->
            </figure>
        </div>
        
                
        <div class="orbit">
            <figure>
                <!-- <img src ="Final_Project/PlanetsPng/OrbitPerspective.jpg"> -->
            </figure>
        
        </div>

        

        
        <div id = "nav">
            <hr size="1" width="100%" color="white"> 
        <ul>
            
            <li><a href="Solar_System.html#nav">The Solar System</a></li>
            <li><a class = "active" href="index.html#nav"> Space Objects </a></li>
            <li><a href="Planetary_Exploration.html#nav">Space Exploration</a></li>
            <li><a href="Future.html#nav">Future</a></li>
            
        </ul>
          <hr size="1" width="100%" color="white">   
        </div>
        
        
    <div id="objects"></div>
        
    <div id="objects-explanation">
        <p1> Number of Space Objects Launched Per Decade </p1><br><br> An official Register of Objects Launched into Outer Space has been kept up to date by the UN since 1962. As international space law developed, space object registration transformed from being a mechanism to assisting the United Nations Committee on the Peaceful Uses of Outer Space in its discussions on the political, legal, and technical issues relating to outer space. Now, it serves to identify which States have international responsibility and liability for space objects. 8,261 distinct satellites are circling the Earth, up 11.84% from April 2021, according to UNOOSA's Index of Objects Launched into Outer Space. There were 12, 293 objects launched into space at the end of January 2022. It has been estimated that an additional 58,000 will be launched by 2030.<br> Data Source: https://www.unoosa.org/oosa/osoindex/search-ng.jspx
 </div>
        
    <div id="status"></div>
    <div id="status-explanation">
    <p1>Only 4852 satellites <br> in orbit are active; <br> rest is inactive. </p1><p><br>As of the end of December 2021, just 4,852 of the 8,261 satellites circling the Earth were active, according to UNOOSA data, which were corroborated by the Union of Concerned Scientists (UCS), which keeps track of the functioning satellites. According to UCS, as of the first of January 2021, there were 6,542 satellites in orbit, 3,372 of which were operational and 3,170 idle.</p></div>
    <div id="orbit">
        <figure>
            <img src ="Final_Project/PlanetsPng/EarthOrbit-01.jpg">
        </figure></div>
    <div id="orbits-explanation">
          <p1> Number of Active Satellites <br>Per Orbit Type </p1>
        <p>Low Earth Orbit (LEO)
LEO is commonly used for communication and remote sensing satellite systems, as well as the International Space Station (ISS) and Hubble Space Telescope.
Medium Earth Orbit
        MEO is commonly used for navigation systems, including the U.S. Global Positioning System (GPS).
Geosynchronous Orbit (GSO) & Geostationary Orbit (GEO)
GSO objects maintain a constant position over a specific longitude because their orbital speed coincides with the rotation of the Earth. A subset of GSO is GEO. While GEO objects only orbit Earth's equator and, from the ground, appear in a fixed position in the sky, its rotation equals that of the planet. For communication and Earth observation, GSO and GEO are utilized. Highly Elliptical Orbit (HEO)
An HEO is oblong, with one end nearer the Earth and other more distant. Satellites in HEO are suited for communications, satellite radio, remote sensing and other applications.<br>Data Source: https://dewesoft.com/daq/every-satellite-orbiting-earth-and-who-owns-them


          </p></div>
    <div id="orbits-chart"></div>
    <div id="piechart"></div>
    <div id="piechart-explanation">
        Data Source: https://dewesoft.com/daq/every-satellite-orbiting-earth-and-who-owns-them <br>
        Government agencies no longer have exclusive control over the space environment. Due to the entry of private enterprises, the exploration industry is moving more quickly and vigorously than it would if it were left to governments alone. One may argue that a new space race has started, in which private businesses are vying with one another and with governmental agencies. Instead of the desire to demonstrate supremacy by being the first to accomplish a given goal, it is motivated by competition for clients this time. Even now, SpaceX plans to launch 42,000 satellites into orbit over the next two decades! WHY?
There are numerous uses for the satellites that orbit the Earth. Including items like television, telephones, radio, the Internet, and military uses, more than half of Earth satellites are used for communications. In geostationary orbit, the majority of these communication satellites can be found. Numerous more applications for the thousands of satellites in the sky include navigation and global positioning, Earth and space science, technological development and demonstration, and Earth and space observation.
</div>


   

<script>

const margin = {top: 100, right: 30, bottom: 30, left: 60},
        width = 1000 - margin.left - margin.right,
        height = 600 - margin.top - margin.bottom;
    
    // append the svg object to the body of the page
    const svg = d3.select("#chart")
      .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);


    

    
    
    
    ObjectsLaunched()
    function ObjectsLaunched() {
       
        
        
             
        var w = 550;
        var h = 380;
        var padding = 60;
        
        var svg3 = d3.select("#objects")
						.append("svg")
						.attr("width", w)
						.attr("height", h);
        
        d3.csv("Objects.csv")
        .then(function(data) {
            dataset = data;
            var xScale = d3.scaleBand()
                .domain(data.map(function(d) { return d.Decade; }))
                .range([padding,w-padding])
       
            
            
            var yScale = d3.scaleLinear()
                .domain([
                    0,
                    d3.max(dataset, function(d) {return parseInt(d.Objects)})
                ])
                .range([h-padding,padding]);
            
            xAxis = d3.axisBottom()
                .scale(xScale)
        
            
            yAxis = d3.axisLeft()
                .scale(yScale)
                .ticks(10);
                
            
            
        svg3.selectAll("line")
           .data(dataset)
           .enter()
           .append("line")
           .attr("x1", function(d,i) {
                return xScale(d.Decade)})
           
            .attr("y1", h-padding)
           .attr("x2", function(d,i) {
                return xScale((d.Decade));
           })
           .attr("y2", function(d) {
                return yScale(parseFloat(d.Objects));
           })
           .attr("stroke", "gray")
           .attr("stroke-width", 3)
             .attr("transform", "translate(" + xScale.bandwidth()/2 + ", 0)")
            .on("mouseover", function(d,i) {
                d3.select(this).attr("stroke","white").attr("stroke-width", 4)
                
            
                var xPosition = parseFloat(d3.select(this).attr("x1"));
                var yPosition = parseFloat(d3.select(this).attr("y2"));
        
                svg3.append("text")
                   .attr("id", "tooltip")
                   .attr("x", xPosition +20)
                    .attr("y", yPosition-20)
                   .attr("text-anchor", "start")
                   .attr("font-size", "15px")
                   .attr("font-weight", "bold")
                   .attr("fill", "white")
                   .text(d.Objects)
            
            
            })
            .on("mouseout", function(d,i) {
                d3.select(this).attr("stroke","grey").attr("stroke-width", 3)
                d3.select("#tooltip").remove();
                });
            
            
            
             svg3.append("path")
          .datum(data)
          .attr("fill", "none")
          .attr("stroke", "white")
          .attr("stroke-width", 2)
          .attr("transform", "translate(" + xScale.bandwidth()/2 + ", 0)")
          .attr("d", d3.line()
            .x(function(d) { return xScale(d.Decade) })
            .y(function(d) { return yScale((d.Objects) )})
            );
            
            
            
        svg3.selectAll("circle")
            .attr("id", "circle")
            .data(dataset)
            .enter()
            .append("circle")
            .attr("fill", "white")
            .attr("transform", "translate(" + xScale.bandwidth()/2 + ", 0)")
            .attr("cx", function (d) {
                return xScale(d.Decade);
        })
            .attr("cy", function (d) {
                return yScale(parseInt(d.Objects));
        })
            .attr("r", 3.5);
            
            
            
            
            svg3.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(0," + (h- padding) + ")")
                .call(xAxis)
            .selectAll("text")
                //.attr("font-size", 16);

            
            svg3.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(" + padding + ",0)")
                .call(yAxis)
            .selectAll("text")
            
            
             svg3.append("text")
          .attr("x",20)
          .attr("y", 50)
          .attr("text-anchor", "start")
          .text("Data Source: https://www.unoosa.org/oosa/osoindex/search-ng.jspx")
          .style("font-size", 10)
          .style("fill", "white");
   
            
        })
        
    }

    
    SatellitePieChart()
    function SatellitePieChart() {
        var w = 310
        var h = 350
        var padding = 50;
        
        var svg6 = d3.select("#piechart").append("svg").attr("width",w).attr("height",h)
        d3.csv("Satellites.csv")
        .then(function(data){
       
            
            
            var colors1 = ["#D34418","#FFD81C", "#AFCE36", "#59e9b0", "#6c7c3f", "#D4206C", "#4DBE9A", "#00CFDC",  "#AFCE36", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69"];
           
            pieChart(data,"Amount",120,70,svg,colors1,w/2)

        })
            
            
    function pieChart(data,column,inner,outer,svg,colors,x){       
        var pie = d3.pie();
        var arc = d3.arc().innerRadius(inner).outerRadius(outer);
      
        var array = [];
        for(var d in data){
            array.push(data[d][column])
        }
        
        var categories = [];
        for (var i in data) {
            categories.push(data[i].Country)
        }
        
        var arcs = svg6.selectAll("g.arc")
                .data(pie(array))
                .enter()
                .append("g")
                .attr("class",column)
                .attr("transform", "translate(" + x+ "," + h/2+ ")")
                .append("path")
                .attr("fill", function(d, i) {
                    return colors[i];
                })
                .attr("d", arc);  
        
        var numberArray = array.map(Number)
        console.log(numberArray)
        
    
     for (i=0;i<=2;i++) {
            svg6.append("text")
              .attr("x", w/2)
              .attr("y", h/2-20+i*25)
              .attr("text-anchor", "middle")
              .attr("alignment-baseline", "central")
              .text(i+1 + ". " + categories[i]+ ": " + array[i])
              .style("font-size", 25-i*3)
              .style("fill", "white");
    
        }
    
        svg6.append("text")
          .attr("x", w / 2)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .text("Satellites Per Country")
          .style("font-size", 25)
         // .style("font-family", "Verdana")
          .style("fill", "white");
    
     
        
    }
    
    SatelliteOrganizations()
    function SatelliteOrganizations() {
        var w = 310
        var h = 350
        var padding = 50;
        
        var svg6 = d3.select("#piechart").append("svg").attr("width",w).attr("height",h)
        d3.csv("Organizations.csv")
        .then(function(data){
       
            
            
            var colors1 = ["#D34418","#FFD81C", "#AFCE36", "#59e9b0", "#6c7c3f", "#D4206C", "#4DBE9A", "#00CFDC",  "#AFCE36", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69"];
           
            pieChart(data,"Amount",120,70,svg,colors1,w/2)

        })
            
            
    function pieChart(data,column,inner,outer,svg,colors,x){       
        var pie = d3.pie();
        var arc = d3.arc().innerRadius(inner).outerRadius(outer);
      
        var array = [];
        for(var d in data){
            array.push(data[d][column])
        }
        
        var categories = [];
        for (var i in data) {
            categories.push(data[i].Organization)
        }
        
        
        var arcs = svg6.selectAll("g.arc")
                .data(pie(array))
                .enter()
                .append("g")
                .attr("class",column)
                .attr("transform", "translate(" + x+ "," + h/2+ ")")
                .append("path")
                .attr("fill", function(d, i) {
                    return colors[i];
                })
                .attr("d", arc);  
        
        
        
        for (i=0;i<=2;i++) {
            svg6.append("text")
              .attr("x", w/2)
              .attr("y", h/2-20+i*25)
              .attr("text-anchor", "middle")
              .attr("alignment-baseline", "central")
              .text(i+1 + ". " + categories[i]+ ": " + array[i])
              .style("font-size", 25-i*3)
              .style("fill", "white");
            
        }

        
    
    }
    
    svg6.append("text")
          .attr("x", w / 2)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .text("Satellites Per Organization")
          .style("font-size", 25)
          .style("fill", "white");
    
     
        
    }
    
    SatellitePurpose()
    function SatellitePurpose() {
        var w = 310
        var h = 350
        var padding = 50;
        
        var svg6 = d3.select("#piechart").append("svg").attr("width",w).attr("height",h)
        d3.csv("Purpose.csv")
        .then(function(data){
       
            
            
            var colors1 = ["#D34418","#FFD81C", "#AFCE36", "#59e9b0", "#6c7c3f", "#D4206C", "#4DBE9A", "#00CFDC",  "#AFCE36", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69"];

           
            pieChart(data,"Percentage",120,70,svg,colors1,w/2)

        })
            
            
    function pieChart(data,column,inner,outer,svg,colors,x){       
        var pie = d3.pie();
        var arc = d3.arc().innerRadius(inner).outerRadius(outer);
      
        var array = [];
        for(var d in data){
            array.push(data[d][column])
        }
        
        

        var categories = [];
        for (var i in data) {
            categories.push(data[i].Service)
        }

        
        
        var arcs = svg6.selectAll("g.arc")
                .data(pie(array))
                .enter()
                .append("g")
                .attr("class",column)
                .attr("transform", "translate(" + x+ "," + h/2+ ")")
                .append("path")
                .attr("fill", function(d, i) {
                    return colors[i];
                })

                .attr("d", arc);  

        
        for (i=0;i<=2;i++) {
            svg6.append("text")
              .attr("x", w/2)
              .attr("y", h/2-20+i*20)
              .attr("text-anchor", "middle")
              .attr("alignment-baseline", "central")
              .text(i+1 + ". " + categories[i]+ ": " + array[i]*100 + "%")
              .style("font-size", 20-i*3)
              .style("fill", "white");
            
        }

    }
    
    svg6.append("text")
          .attr("x", w / 2)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .text("Satellites per Purpose")
          .style("font-size", 25)
          .style("fill", "white");
        
        
        

    }
    

    
    Orbits();
    function Orbits() {
        
        
        var w = 700;
        var h = 280;
        var padding = 100;
        var paddingtop = 20;
        
     var svg8 = d3.select("#orbits-chart")
						.append("svg")
						.attr("width", w)
						.attr("height", h);
            

        //Load in the data
        d3.csv("Orbits.csv")
        .then(function(data) {
            dataset = data;           

            
          
            var xScale = d3.scaleBand()
                .domain(data.map(function(d) { return d.Orbit;}))
                .range([paddingtop,h-paddingtop])
                .paddingInner(0.3)
                .paddingOuter(0.3);
            
            
            var yScale = d3.scaleLinear()
                .domain([
                    0,
                    d3.max(data, function(d) {return parseFloat(d.Value)})
                ])
                .range([padding,w-padding]);
            
            xAxis = d3.axisBottom()
                .scale(yScale)
        
            
            yAxis = d3.axisLeft()
                .scale(xScale)
                .ticks(10);
                
           
            svg8.selectAll("rect")
                .data(data)
                .enter()
                .append("rect")
                .attr("x", padding)    
                .attr("y", function(d) {
                    return xScale(d.Orbit) })
            
                .attr("height", xScale.bandwidth())
                .attr("width", function(d) {
                return yScale(parseFloat(d.Value))-padding})
            
                .attr("fill", "#D34418");
            
            svg8.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(0," + (h - paddingtop) + ")")
                .call(xAxis)
            .selectAll("text")

                .attr("font-size", 10)
                .attr("alignment-baselinet", "central");
            
            svg8.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(" + padding + ",0)")
                .call(yAxis)
            .selectAll("text")
                .attr("font-size", 10)
          
              svg8.append("text")
          .attr("x",w-90)
          .attr("y", h-30)
          .attr("text-anchor", "end")
          .text("Data Source: https://dewesoft.com/daq/every-satellite-orbiting-earth-and-who-owns-them")
          .style("font-size", 10)
          .style("fill", "white");
   
            
        })
}
    
    
    Bubble ()
    function Bubble() {
        
        var diameter = 800, //max size of the bubbles
    format   = d3.format(",d"),
    
    color    = d3.scaleOrdinal(["#D34418","#35A2C9", "#AFCE36", "#59e9b0", "#6c7c3f", "#D4206C", "#4DBE9A", "#00CFDC",  "#AFCE36", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69", "#68b859","#cbcf49","#6c7c3f","#7fdf4a","#c2d199","#647c77","#59e9b0","#478573","#8fd8ca","#42ab80", "#6C2C69"]);
    //more color options: https://github.com/d3/d3-scale-chromatic

var bubble = d3.pack()
    .size([600, 700])
    .padding(4);

var svg7 = d3.select("#status")
    .append("svg")
    .attr("width", 900)
    .attr("height", 600)
    .attr("class", "bubble");
        
    
        

    
    d3.csv("Total_Objects_Launched.csv")
    .then(function(data){
        var nested_data = d3.nest()
            .key(function(d) { return d.Status; })
            .rollup(function(leaves) { return leaves.length; })
            .entries(data); 
        
    
        
        svg7.append("text")
            .attr("x", diameter/2)
            .attr("y", 20)
            .attr("text-anchor", "middle")
            .text("Status of Space Objects")
            .style("font-size", 25)
          //  .style("font-family", "Verdana")
            .style("fill", "white")


    //convert numerical values from strings to numbers
    //data = nested_data.map(function(d){ d.value = +d.value; d.key = d.key; return d; });
        
        

    //Sets up a hierarchy of data object
    var root = d3.hierarchy({children:nested_data})
      .sum(function(d) { return d.value; })
      .sort(function(a, b) { return b.value - a.value; });

    //Once we have hierarchal data, run bubble generator
    bubble(root);

        
    //setup the chart
    var bubbles = svg7.selectAll(".bubble")
        .data(root.children)
        .enter();
        
        console.log(root.children)
        
    //create the bubbles
    bubbles.append("circle")
        .attr("class", "circle")
        .attr("r", function(d){ return d.r; })
        .attr("cx", function(d){ return d.x; })
        .attr("cy", function(d){ return d.y; })
        .style("fill", function(d) { return color(d.value); })
        
        .on("mouseover", function(d,i) {
                d3.select(this)
                     .transition()
                    .duration(100)
                    .attr("r", function(d) { return d.r + 5})
        })
    
    
        
        .on("mouseout", function() {
            d3.select(this)
                .transition()
                .duration(100)
                .attr("r", function(d) { return d.r})
            ;
            });
        
        
        
        
    //format the text for each bubble
    bubbles.append("text")
        .attr("x", function(d){ return d.x; })
        .attr("y", function(d){ return d.y -5;})
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .text(function(d) {
        if(d.r> 30) {
            return d.data["key"]}
 
        else {
        return " ";
        }})
        
        .style("fill","white")
        //.style("font-family", "Helvetica Neue, Helvetica, Arial, san-serif")
        .attr("font-size", function(d) {return d.r/3})
        ;
        
        
    bubbles.append("text")
        .attr("x", function(d){ return d.x; })
        .attr("y", function(d){ return d.y + d.r/3 -5; })
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .text(function(d) {
        if(d.r> 30) {
            return d.value}
        
        else {
        return " ";
        }})
        .style("fill","white")
        //.style("font-family", "Helvetica Neue, Helvetica, Arial, san-serif")
        .style("font-size", function(d) {return d.r/3});

         svg7.append("text")
          .attr("x", 20)
          .attr("y", height+120)
          .attr("text-anchor", "start")
          .text("Data Source: https://www.unoosa.org/oosa/osoindex/search-ng.jspx")
          .style("font-size", 10)
          .style("fill", "white");
   
 
        
    

	var legendG = svg7.selectAll(".legend") 
	  .data(root.children)
	  .enter().append("g")
	  .attr("transform", function(d,i){
		return "translate("+680+"," + (100 + i * diameter/40 + diameter/40) + ")"; 
	  })
	  .attr("class", "legend");   

	legendG.append("rect") 
	  .attr("width", 10)
	  .attr("height", 10)
        .style("fill", function(d) { 
            return color(d.value); 
            });
        
     legendG.append("text") 
	  .text(function(d){
		return d.data["key"] + ": " + d.value
	  })
	  .style("font-size", 10)
	  .attr("y", 10)
	  .attr("x", 15) 
        .attr("fill", "white")
        
       
    }
    
  )
}
    };
    
        
   
              
		</script>
        
        
        
</body>

</html>

